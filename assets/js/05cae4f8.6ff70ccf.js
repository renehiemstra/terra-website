"use strict";(self.webpackChunkterra_website=self.webpackChunkterra_website||[]).push([[9311],{1777:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>i,metadata:()=>a,toc:()=>u});const a=JSON.parse('{"id":"features/tutorial/move-vs-value","title":"Tutorial - Value versus Move Semantics","description":"In this tutorial, we explore Terra\u2019s generative programming capabilities. In","source":"@site/docs/features/tutorial/multistage-programming.mdx","sourceDirName":"features/tutorial","slug":"/features/tutorial/move-vs-value","permalink":"/terra-website/docs/features/tutorial/move-vs-value","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/features/tutorial/multistage-programming.mdx","tags":[],"version":"current","frontMatter":{"id":"move-vs-value","title":"Tutorial - Value versus Move Semantics"}}');var n=t(4848),o=t(8453);t(4853);const i={id:"move-vs-value",title:"Tutorial - Value versus Move Semantics"},s="Tutorial - Multistage Programming",l={},u=[{value:"Tutorial 1: Support for Lamda expressions as a compiler extension",id:"tutorial-1-support-for-lamda-expressions-as-a-compiler-extension",level:2}];function d(e){const r={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"tutorial---multistage-programming",children:"Tutorial - Multistage Programming"})}),"\n",(0,n.jsx)(r.p,{children:"In this tutorial, we explore Terra\u2019s generative programming capabilities. In"}),"\n",(0,n.jsx)(r.h2,{id:"tutorial-1-support-for-lamda-expressions-as-a-compiler-extension",children:"Tutorial 1: Support for Lamda expressions as a compiler extension"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-terra",metastring:"file=./tutorials/tutorial-resource-management/tutorial-lambda.t start=lambda_new_start end=lambda_new_end",children:'local ckecklambdaexpr = function(expr)\n    if not (expr.tree and expr.tree.type and expr.tree.type:isstruct()) then\n        error("Not a valid capture. " ..\n              "The capture syntax uses named arguments as follows: " ..\n              "{x = xvalue, ...}.", 2)\n    end\nend\n\nlocal makelambda = function(fun, lambdaobj)\n    --check capture object\n    ckecklambdaexpr(lambdaobj)\n    local lambdatype = lambdaobj:gettype()\n    --overloading the call operator - making \'lambdaobj\' a function object\n    lambdatype.metamethods.__apply = macro(terralib.memoize(function(self, ...)\n        local args = terralib.newlist{...}\n        return `fun([args], unpackstruct(self))\n    end))\n    --add returntype and parameter info if available\n    local funtype = fun:gettype()\n    if funtype:ispointertofunction() then\n        lambdatype.returntype = funtype.type.returntype\n        local nargs = #funtype.type.parameters - #lambdatype.entries\n        lambdatype.parameters = funtype.type.parameters:filteri(function(i,v) return i <= nargs end)\n    end\n    return lambdaobj\nend \n\n--return a function object with captured variables in ...\nlocal new = macro(function(fun, capture)\n    local lambda = makelambda(fun, capture or quote var c : terralib.types.newstruct() in c end)\n    return `lambda\nend)\n'})})]})}function c(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},4853:(e,r,t)=>{t.d(r,{c:()=>o,x:()=>n});t(6540);var a=t(4848);const n=e=>{let{children:r}=e;return(0,a.jsx)("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:r})},o=e=>{let{children:r,title:t}=e;return(0,a.jsxs)("div",{style:{flex:1,minWidth:"300px"},children:[t&&(0,a.jsx)("div",{style:{color:"var(--ifm-font-color-base)",padding:"0.5rem 1rem",borderRadius:"var(--ifm-pre-border-radius, 4px) var(--ifm-pre-border-radius, 4px) 0 0",borderBottom:"none",fontSize:"0.9rem",fontWeight:"bold"},children:t}),(0,a.jsx)("div",{style:{marginTop:t?"0":"inherit",borderRadius:t?"0 0 var(--ifm-pre-border-radius, 4px) var(--ifm-pre-border-radius, 4px)":"var(--ifm-pre-border-radius, 4px)",overflow:"hidden"},children:r})]})}},8453:(e,r,t)=>{t.d(r,{R:()=>i,x:()=>s});var a=t(6540);const n={},o=a.createContext(n);function i(e){const r=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),a.createElement(o.Provider,{value:r},e.children)}}}]);